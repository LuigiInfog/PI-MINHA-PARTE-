<!-- templates/relatorio.html -->
{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Relat√≥rio - {{ investigacao.titulo }}</title>
    <style>
        body { background:#0b1220; color:#f0f0f0; font-family:sans-serif; padding:0; margin:0; }
        header { display:flex; justify-content:space-between; align-items:center; background:#12233e; padding:15px 30px; border-bottom:3px solid #00aaff; }
        header h1 { color:#00aaff; margin:0; }
        nav a { color:#c0d8f0; margin-left:20px; text-decoration:none; font-weight:500; }
        nav a:hover { color:#00aaff; }
        .container { max-width:1200px; margin:30px auto; padding:0 20px; }
        .card { background:#12233e; padding:25px; border-radius:10px; margin:20px 0; box-shadow:0 0 20px rgba(0,170,255,0.2); border:1px solid #1e3a5c; }
        .investigacao-title { color:#00aaff; font-size:1.8rem; margin-bottom:20px; }
        .info-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-bottom:25px; }
        .info-item { background:#1a2d46; padding:15px; border-radius:6px; }
        .info-label { color:#88b1d1; font-size:0.9rem; margin-bottom:5px; }
        .info-value { color:#f0f0f0; font-weight:500; }
        .descricao { background:#1a2d46; padding:20px; border-radius:6px; margin:25px 0; line-height:1.6; }
        
        .relacionadas-section { margin-top:40px; border-top:2px solid #00aaff; padding-top:25px; }
        .relacionadas-title { color:#00aaff; font-size:1.4rem; margin-bottom:20px; }
        .relacionada-card { background:#1a2d46; padding:20px; border-radius:8px; margin-bottom:15px; border-left:4px solid #00aaff; }
        .relacionada-titulo { color:#00aaff; font-size:1.1rem; margin-bottom:8px; }
        .relacionada-meta { color:#88b1d1; font-size:0.9rem; margin-bottom:10px; }
        .relacionada-motivos { background:#12233e; padding:10px; border-radius:4px; margin-top:10px; }
        .motivo-item { color:#22cc88; font-size:0.9rem; margin:2px 0; }
        .pontuacao { background:#00aaff; color:white; padding:2px 8px; border-radius:12px; font-size:0.8rem; float:right; }
        
        .btn { padding:10px 20px; margin-right:12px; border:none; border-radius:6px; cursor:pointer; text-decoration:none; display:inline-block; font-weight:500; }
        .btn-primary { background:#00aaff; color:white; }
        .btn-primary:hover { background:#0088cc; }
        .btn-secondary { background:#22cc88; color:white; }
        .btn-secondary:hover { background:#009955; }
    </style>
</head>
<body>
    <header>
        <h1>PFI - Relat√≥rio de Investiga√ß√£o</h1>
        <nav>
            <a href="{% url 'investigacoes' %}">‚Üê Voltar</a>
            <a href="{% url 'index' %}">In√≠cio</a>
        </nav>
    </header>

    <div class="container">
        <div class="card">
            <h1 class="investigacao-title">{{ investigacao.titulo }}</h1>
            
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Respons√°vel</div>
                    <div class="info-value">{{ investigacao.responsavel }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Status</div>
                    <div class="info-value">{{ investigacao.status }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Data de In√≠cio</div>
                    <div class="info-value">{{ investigacao.data_inicio }}</div>
                </div>
                {% if investigacao.data_fim %}
                <div class="info-item">
                    <div class="info-label">Data de Conclus√£o</div>
                    <div class="info-value">{{ investigacao.data_fim }}</div>
                </div>
                {% endif %}
                {% if investigacao.localizacao %}
                <div class="info-item">
                    <div class="info-label">Localiza√ß√£o</div>
                    <div class="info-value">{{ investigacao.localizacao }}</div>
                </div>
                {% endif %}
                {% if investigacao.categoria %}
                <div class="info-item">
                    <div class="info-label">Categoria</div>
                    <div class="info-value">{{ investigacao.categoria }}</div>
                </div>
                {% endif %}
            </div>
            
            <div class="descricao">
                <h3 style="color:#00aaff; margin-bottom:15px;">Descri√ß√£o da Investiga√ß√£o</h3>
                <p style="white-space: pre-line;">{{ investigacao.descricao }}</p>
            </div>
            
            <div style="text-align:center; margin-top:30px;">
                <a href="{% url 'investigacoes' %}" class="btn btn-primary">Voltar √† Lista</a>
                <a href="{% url 'relatorio_investigacao_pdf' investigacao.id %}" class="btn btn-secondary">üìÑ Baixar PDF</a>
            </div>
        </div>

        {% if relacionadas %}
        <div class="relacionadas-section">
            <h2 class="relacionadas-title">üîç Investiga√ß√µes Relacionadas</h2>
            <p style="color:#88b1d1; margin-bottom:20px;">
                O sistema identificou automaticamente estas investiga√ß√µes que podem estar relacionadas:
            </p>
            
            {% for rel in relacionadas %}
            <div class="relacionada-card">
                <span class="pontuacao">{{ rel.pontuacao }} pts</span>
                <h3 class="relacionada-titulo">{{ rel.investigacao.titulo }}</h3>
                <div class="relacionada-meta">
                    <strong>Respons√°vel:</strong> {{ rel.investigacao.responsavel }} | 
                    <strong>Status:</strong> {{ rel.investigacao.status }} | 
                    <strong>In√≠cio:</strong> {{ rel.investigacao.data_inicio }}
                </div>
                <p style="color:#c0d8f0; margin:10px 0;">{{ rel.investigacao.descricao|truncatewords:30 }}</p>
                
                {% if rel.motivos %}
                <div class="relacionada-motivos">
                    <strong style="color:#00aaff;">Motivos do relacionamento:</strong>
                    {% for motivo in rel.motivos %}
                    <div class="motivo-item">‚Ä¢ {{ motivo }}</div>
                    {% endfor %}
                </div>
                {% endif %}
                
                <div style="margin-top:15px;">
                    <a href="{% url 'relatorio_investigacao' rel.investigacao.id %}" class="btn btn-primary" style="padding:6px 12px; font-size:0.9rem;">
                        Ver Detalhes
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</body>
</html>